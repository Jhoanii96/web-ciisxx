<?php
/* 
    
    AUTOR DE PROGRAMACIÓN PHP: 
    JHON ALVARADO ACHATA
    
*/

require ROOT.FOLDER_PATH."/system/libs/Session.php";require ROOT.FOLDER_PATH."/app/models/admin/adminModel.php";class notify extends Controller{public function index(){}public function notifications(){function time2str($ts){date_default_timezone_set('America/Lima');if(!ctype_digit($ts)){$ts=strtotime($ts);}$fecha_ahora=(new \DateTime())->format('Y-m-d H:i:s');$fecha_ahora=strtotime($fecha_ahora);$diff=$fecha_ahora-$ts;if($diff==0){return 'now';}elseif($diff>0){$day_diff=floor($diff/86400);if($day_diff==0){if($diff<60)return 'Justo ahora';if($diff<120)return 'Hace 1 minuto';if($diff<3600)return 'Hace '.floor($diff/60).' minutos';if($diff<7200)return 'Hace 1 hora';if($diff<86400)return 'Hace '.floor($diff/3600).' horas';}if($day_diff==1){return 'Ayer';}if($day_diff<7){return 'Hace '.$day_diff.' días';}if($day_diff<31){return 'Hace '.ceil($day_diff/7).' semanas';}if($day_diff<60){return 'El mes pasado';}return date('F Y',$ts);}else{$diff=abs($diff);$day_diff=floor($diff/86400);if($day_diff==0){if($diff<120){return 'in a minute';}if($diff<3600){return 'in '.floor($diff/60).' minutes';}if($diff<7200){return 'in an hour';}if($diff<86400){return 'in '.floor($diff/3600).' hours';}}if($day_diff==1){return 'Tomorrow';}if($day_diff<4){return date('l',$ts);}if($day_diff<7+(7-date('w'))){return 'next week';}if(ceil($day_diff/7)<4){return 'in '.ceil($day_diff/7).' weeks';}if(date('n',$ts)==date('n')+1){return 'next month';}return date('F Y',$ts);}}$this->model=new adminModel();$this->BellNtf=$this->model->BellNotifications();echo '<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell-o"></i><span class="label label-warning">N</span></a><ul class="dropdown-menu" style="width: 350px;"><li class="header">Notificaciones</li><li><!-- inner menu: contains the actual data --><ul class="menu">';while($datoBellNotificacion=$this->BellNtf->fetch_array()){$fecha=time2str($datoBellNotificacion['date_notify']);echo '<li><a href="'.FOLDER_PATH.'/admin/preinscriptions/show/'.$datoBellNotificacion['id_inscripcion'].'" target="_blank" style="display: flex;"><div style="width: 70%;"><span>'.$datoBellNotificacion['name_notify'].'</span></div><div style="width: 30%;"><small><i class="fa fa-clock-o"></i> '.$fecha.'</small></div></a></li>';}echo '</ul></li></ul>';}public function asistentes(){$this->model=new adminModel();$this->NumUsu=$this->model->mostrar_numero_AsistentesPendientes();while($datoNumUsuario=$this->NumUsu->fetch()){echo $datoNumUsuario['num_usuario'];}}}